__Источник:__ [Environment-specific configuration in Zend Framework 2][1]  
__Автор:__ [Evan Coury][2]  
__Перевод:__ [Лобач Олег][3]  

Итак, вам всем не терпится попробовать ZF2. Вы [клонировали skeleton, установили некоторые модули][4], может даже прошли [отличный учебник Роба Аллена по ZF2][5], и, наконец, начали разработку своего приложения. Теперь, если вы бывший пользователь ZF1 или перебежчик из другого фреймворка, вас может обеспокоить тот факт, что, на первый взгляд, ZF2 не обращает внимания на параметры конфигурации, зависящие от окружения (например, разработка, тестирование, опытная эксплуатация, промышленная эксплуатация). К счастью, это не так!

## Способ в стиле ZF2 (рекомендуемый)

Официально одобренным "способом ZF2" является понятие "локальные" конфигурационные файлы. То есть, если в определенном окружении понадобится значение конфигурационного параметра отличное от значения "по умолчанию", вы поместите его в локальный для этого окружения конфигурационный файл. Согласно соглашению, эти локальные конфигурационные файлы игнорируются системами контроля версий. Такая практика помогает избежать попадание "чувствительных" данных, таких как логин и пароль к базе данных, в систему управления исходным кодом, однако она оставляет ответственность за развертывание (_deployment_) этих "локальных" конфигурационных файлов на пользователя и особенности его процесса развертывания.

Индивидуально для каждого из локальных конфигурационных файлов, которые есть в моем приложении, я добавляю в систему контроля версий .dist-вариант с удалением всех "чувствительных" данных. Тогда задача развертывания будет заключаться в простом копировании .dist файла и заполнения соответствующих значений для конкретного окружения, а в некоторых случаях .dist-файлы даже могут содержать специфичные для какого-то окружения параметры (но только если они не представляют угрозу безопасности!). Например, у меня может быть файл `./config/autoload/logger.local.php.dist-testing` в котором отключается логгер; с установленным обработчиком на окончание получения (_post-receive hook_ [^1]) или задачей "перед установкой" (_before_install task_) для travis-ci которые копируют файл без расширения `.dist-testing`. До сих пор для меня этот способ работает вполне успешно.

## Способ в стиле ZF1 (для застрявших в прошлом)

Однако, если все эти "локальные" конфигурационные файлы и даром вам не нужны, то очень просто вернуть старое поведение. Откройте ваш `config/application.config.php` и добавьте дополнительный глобальный путь (строка 9):

<pre lang="php"><code>
<?php
return array(
    'modules' => array(
        'Application',
    ),
    'module_listener_options' => array(
        'config_glob_paths'    => array(
            'config/autoload/{,*.}{global,local}.php',
            'config/autoload/{,*.}' . (getenv('APPLICATION_ENV') ?: 'production') . '.php',
        ),
        'module_paths' => array(
            './module',
            './vendor',
        ),
    ),
);
</code></pre>

**Примечание:** В приведенном выше примере, я установил `production` в качестве среды по умолчанию, если переменная окружения `APPLICATION_ENV` не установлена. Конечно, Вы можете изменить это, хотя это вообще лучшая практика предположить, что приложение работает в режиме `production` всякий раз, когда переменная окружения каким-то образом становится неопределенной в "производственной" среде.

Теперь вы можете добавить конфигурационные файлы такие как `./config/autoload/logger.staging.php`, которые будут загружаться только на сервере с переменная окружения `APPLICATION_ENV` установленной в `‘staging’`. Это дает вам привычный функционал, который давали вам разделы config/ini в ZF1.

Наслаждайтесь, но пожалуйста помните о том, что нельзя сохранять "чувствительную" информацию, такую как учетные данные аккаунта в базе данных, в системе контроля версий.

[1]: http://blog.evan.pro/environment-specific-configuration-in-zend-framework-2
[2]: http://evan.pro/
[3]: http://lobach.info/
[4]: http://blog.evan.pro/getting-started-with-the-zf2-skeleton-and-zfcuser
[5]: http://zf2.readthedocs.org/en/latest/index.html#userguide

[^1]: На сколько я понимаю, имеется в виду хук в системе контроля версий, который срабатывает после извлечения рабочей копии из репозитория, - прим.пер.